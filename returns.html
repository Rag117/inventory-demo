<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>반품 관리 - 멍밥 ERP</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <h2>멍밥 ERP</h2>
            <ul>
                <li><a href="dashboard.html">메인 대시보드</a></li>
                <li><a href="admin.html">기준정보 관리</a></li>
                <li><a href="purchase.html">입고 관리</a></li>
                <li><a href="sales.html">수주 관리</a></li>
                <li><a href="stock.html">재고 관리</a></li>
                <li><a href="reports.html">리포트</a></li>
                <li class="active"><a href="returns.html">반품 관리</a></li>
            </ul>
        </nav>
        <main class="dashboard">
            <h1>반품/환불 관리</h1>
            
            <div class="toolbar">
                <button class="btn-primary" onclick="openModal('returnRegModal')">+ 반품 접수 등록</button>
            </div>

            <div class="table-wrapper">
                <table class="sortable-table" id="return-table">
                    <thead>
                        <tr>
                            <th>반품ID</th>
                            <th>접수일</th>
                            <th>상품명</th>
                            <th>수량</th>
                            <th>반품처(고객)</th>
                            <th>상태</th>
                            <th>관리</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </main>
    </div>

    <div id="returnRegModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>반품 접수 등록</h2>
                <span class="close" onclick="closeModal('returnRegModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>반품 상품 선택</label>
                    <select id="ret-sku-select"></select>
                </div>
                <div class="form-group">
                    <label>반품 수량</label>
                    <input type="number" id="ret-qty" value="1">
                </div>
                <div class="form-group">
                    <label>원래 구매일 (Original Date)</label>
                    <input type="date" id="ret-org-date">
                </div>
                <div class="form-group">
                    <label>반품처 (고객명/사이트)</label>
                    <input type="text" id="ret-customer" placeholder="예: 냥이월드">
                </div>
                <div class="form-group">
                    <label>반품 사유</label>
                    <input type="text" id="ret-reason" placeholder="예: 배송 중 파손, 단순 변심">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="registerReturn()">접수 등록</button>
            </div>
        </div>
    </div>

    <div id="returnProcessModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>반품 처리 (승인)</h2>
                <span class="close" onclick="closeModal('returnProcessModal')">&times;</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="proc-ret-id">
                <div class="form-group">
                    <label>처리 실행일</label>
                    <input type="date" id="proc-date">
                </div>
                <div class="form-group">
                    <label>처리 방식</label>
                    <select id="proc-action">
                        <option value="RESTOCK">재입고 (반품 창고로 입고)</option>
                        <option value="DISPOSE">폐기 (재고 반영 안함)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="completeReturnProcess()">확정</button>
            </div>
        </div>
    </div>

    <div id="returnDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>반품 상세 정보</h2>
                <span class="close" onclick="closeModal('returnDetailModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div id="detail-content" style="font-size: 0.95em; line-height: 1.8;">
                    </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('returnDetailModal')">닫기</button>
            </div>
        </div>
    </div>

    <script src="sort-table.js"></script>
    <script src="app.js"></script>
    <script>
        // 오늘 날짜 자동 세팅
        const today = new Date().toISOString().split('T')[0];
        // 아래 ID들을 가진 태그가 위 HTML에 반드시 있어야 에러가 안 납니다.
        if(document.getElementById('ret-org-date')) document.getElementById('ret-org-date').value = today;
        if(document.getElementById('proc-date')) document.getElementById('proc-date').value = today;
    </script>
</body>
</html>